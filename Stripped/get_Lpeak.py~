from astro_utils import * 


nis = np.genfromtxt('Prentice/BVRI_stats.dat',usecols=[0,1,2,3,4,5,6,7,8,9],names=('SN','type','Lp','Lperr1','Lperr2','Mni','Mni_err1','Mni_err2','tp','tp_err'),dtype=('S15','S10','f8','f8','f8','f8','f8','f8','f8','f8'))
my_nis = np.genfromtxt('Ni56_peak.dat',usecols=[0,1,2,3],names=('SN','tp','Lp','Mni'),dtype=('S15','f8','f8','f8'))
i1,i2 = overlap(my_nis['SN'],nis['SN'])
pl.plot(my_nis[i1]['Mni'],nis[i2]['Mni'],marker='o',linestyle='None')
x = np.arange(0,0.5,0.01)
pl.xlabel('My Ni56')
pl.ylabel('Prentice Ni56')
pl.plot(x,x)

pl.figure()
pl.plot(np.log10(my_nis[i1]['Lp']),nis[i2]['Lp'],marker='o',linestyle='None')
x = np.arange(41.1,43.5,0.1)
pl.xlabel('My Lp')
pl.ylabel('Prentice Lp')
pl.plot(x,x)

pl.figure()
pl.plot((my_nis[i1]['tp']),nis[i2]['tp'],marker='o',linestyle='None')
x = np.arange(8,40,1)
pl.xlabel('My tp')
pl.ylabel('Prentice tp')
pl.plot(x,x)

pl.show()


band_string = "BVRI"

for SN,z_SN,E_B_V,t_0,d_L in SN_DATA[['sn','sn_z','sn_ebv','t_0','hostlumdist']]:
    print "####### %s ########## \n"%SN
    try: 
    
        os.chdir("%s/"%SN)
        try:
            t,L,logL,Mni = np.genfromtxt('%s_Lbol_%s.dat'%(SN,band_string)).T
            pl.plot(t,logL,marker='o',color='k')
            pl.show()
        except:
            print "No Lbol file"
    except:
        print "No directory %s/"%SN

xs,ys = inter_t[where_inter][where_2nd_peak],L_bol[where_2nd_peak]
k0 = smooth.NonParamRegression(xs, ys, method=npr_methods.SpatialAverage())
k0.fit()
grid = np.arange(np.min(xs),np.max(xs),0.1)
        
        
